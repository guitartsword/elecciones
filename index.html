<!doctype html>
<html>
<head>
  <title>Nasralla | JOH | Diferencia</title>
</head>
<body>
<h1>V 0.0.8</h1>
<p>-Isaias Valle</p>
<pre>
    <font id="show-data" size="30"></font>
</pre>
<button class="button" onclick="loadData()">Reload</button>
<script type="text/javascript">
var getDate = () => fetch("https://api.tse.hn/prod/General/Snapshot/0",{
    method:"GET"
}).then((response) => response.json());
var getData = () =>
fetch ("https://api.tse.hn/prod/ResultadoPresidente/Nacional/0",{
    method:"GET"
}).then((response) => response.json());
var loadData = () => {
    document.getElementById("show-data").innerText = "Loading.......";
    Promise.all([getDate(), getData()]).then(([date, data]) => {
        let votosNacional = 0, votosAlianza = 0, totalVotos = 0;
        let lastUpdate = "";
        lastUpdate = date.FecLocalLarga;
        let lista = data.Lista;
        lista.forEach((data)=>{
            if(data.Partido === "PARTIDO NACIONAL DE HONDURAS")
                votosNacional += data.Votos;
            if(data.Partido === "LIBRE-PINU")
                votosAlianza += data.Votos;
            totalVotos += data.Votos;
        });
        let diferencia = votosAlianza - votosNacional;
        const porcentajeAlianza = parseFloat(votosAlianza/totalVotos*100).toFixed(4);
        const porcentajeNacional = parseFloat(votosNacional/totalVotos*100).toFixed(4)
        const porcentajeDiferencia = parseFloat(porcentajeAlianza - porcentajeNacional).toFixed(4);
        let imprimir = "\nNasralla:\t" + votosAlianza + "\t" + porcentajeAlianza + "%\n" +
        "JOH:\t\t" + votosNacional+ "\t" + porcentajeNacional + "%\n" +
        "Diferencia:\t"+ diferencia + "\t"+ porcentajeDiferencia+"%\n" +
        "Total de Votos:\t" + totalVotos +"\n" +
        lastUpdate;
        document.getElementById("show-data").innerText = imprimir;
    }, (err) => {
        document.getElementById("show-data").innerText = err;
    });
}
loadData();
</script>


</body>
<style>
    .button {
        background-color: #4CAF50; /* Green */
        border: none;
        color: white;
        padding: 15px 32px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
    }
</style>
</html>
